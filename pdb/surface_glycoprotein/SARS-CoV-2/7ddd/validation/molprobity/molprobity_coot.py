# script auto-generated by phenix.molprobity


from __future__ import absolute_import, division, print_function
from six.moves import cPickle as pickle
from six.moves import range
try :
  import gobject
except ImportError :
  gobject = None
import sys

class coot_extension_gui(object):
  def __init__(self, title):
    import gtk
    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)
    scrolled_win = gtk.ScrolledWindow()
    self.outside_vbox = gtk.VBox(False, 2)
    self.inside_vbox = gtk.VBox(False, 0)
    self.window.set_title(title)
    self.inside_vbox.set_border_width(0)
    self.window.add(self.outside_vbox)
    self.outside_vbox.pack_start(scrolled_win, True, True, 0)
    scrolled_win.add_with_viewport(self.inside_vbox)
    scrolled_win.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

  def finish_window(self):
    import gtk
    self.outside_vbox.set_border_width(2)
    ok_button = gtk.Button("  Close  ")
    self.outside_vbox.pack_end(ok_button, False, False, 0)
    ok_button.connect("clicked", lambda b: self.destroy_window())
    self.window.connect("delete_event", lambda a, b: self.destroy_window())
    self.window.show_all()

  def destroy_window(self, *args):
    self.window.destroy()
    self.window = None

  def confirm_data(self, data):
    for data_key in self.data_keys :
      outlier_list = data.get(data_key)
      if outlier_list is not None and len(outlier_list) > 0 :
        return True
    return False

  def create_property_lists(self, data):
    import gtk
    for data_key in self.data_keys :
      outlier_list = data[data_key]
      if outlier_list is None or len(outlier_list) == 0 :
        continue
      else :
        frame = gtk.Frame(self.data_titles[data_key])
        vbox = gtk.VBox(False, 2)
        frame.set_border_width(6)
        frame.add(vbox)
        self.add_top_widgets(data_key, vbox)
        self.inside_vbox.pack_start(frame, False, False, 5)
        list_obj = residue_properties_list(
          columns=self.data_names[data_key],
          column_types=self.data_types[data_key],
          rows=outlier_list,
          box=vbox)

# Molprobity result viewer
class coot_molprobity_todo_list_gui(coot_extension_gui):
  data_keys = [ "rama", "rota", "cbeta", "probe" ]
  data_titles = { "rama"  : "Ramachandran outliers",
                  "rota"  : "Rotamer outliers",
                  "cbeta" : "C-beta outliers",
                  "probe" : "Severe clashes" }
  data_names = { "rama"  : ["Chain", "Residue", "Name", "Score"],
                 "rota"  : ["Chain", "Residue", "Name", "Score"],
                 "cbeta" : ["Chain", "Residue", "Name", "Conf.", "Deviation"],
                 "probe" : ["Atom 1", "Atom 2", "Overlap"] }
  if (gobject is not None):
    data_types = { "rama" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "rota" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                             gobject.TYPE_STRING, gobject.TYPE_FLOAT,
                             gobject.TYPE_PYOBJECT],
                   "cbeta" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT],
                   "probe" : [gobject.TYPE_STRING, gobject.TYPE_STRING,
                              gobject.TYPE_FLOAT, gobject.TYPE_PYOBJECT] }
  else :
    data_types = dict([ (s, []) for s in ["rama","rota","cbeta","probe"] ])

  def __init__(self, data_file=None, data=None):
    assert ([data, data_file].count(None) == 1)
    if (data is None):
      data = load_pkl(data_file)
    if not self.confirm_data(data):
      return
    coot_extension_gui.__init__(self, "MolProbity to-do list")
    self.dots_btn = None
    self.dots2_btn = None
    self._overlaps_only = True
    self.window.set_default_size(420, 600)
    self.create_property_lists(data)
    self.finish_window()

  def add_top_widgets(self, data_key, box):
    import gtk
    if data_key == "probe" :
      hbox = gtk.HBox(False, 2)
      self.dots_btn = gtk.CheckButton("Show Probe dots")
      hbox.pack_start(self.dots_btn, False, False, 5)
      self.dots_btn.connect("toggled", self.toggle_probe_dots)
      self.dots2_btn = gtk.CheckButton("Overlaps only")
      hbox.pack_start(self.dots2_btn, False, False, 5)
      self.dots2_btn.connect("toggled", self.toggle_all_probe_dots)
      self.dots2_btn.set_active(True)
      self.toggle_probe_dots()
      box.pack_start(hbox, False, False, 0)

  def toggle_probe_dots(self, *args):
    if self.dots_btn is not None :
      show_dots = self.dots_btn.get_active()
      overlaps_only = self.dots2_btn.get_active()
      if show_dots :
        self.dots2_btn.set_sensitive(True)
      else :
        self.dots2_btn.set_sensitive(False)
      show_probe_dots(show_dots, overlaps_only)

  def toggle_all_probe_dots(self, *args):
    if self.dots2_btn is not None :
      self._overlaps_only = self.dots2_btn.get_active()
      self.toggle_probe_dots()

class rsc_todo_list_gui(coot_extension_gui):
  data_keys = ["by_res", "by_atom"]
  data_titles = ["Real-space correlation by residue",
                 "Real-space correlation by atom"]
  data_names = {}
  data_types = {}

class residue_properties_list(object):
  def __init__(self, columns, column_types, rows, box,
      default_size=(380,200)):
    assert len(columns) == (len(column_types) - 1)
    if (len(rows) > 0) and (len(rows[0]) != len(column_types)):
      raise RuntimeError("Wrong number of rows:\n%s" % str(rows[0]))
    import gtk
    self.liststore = gtk.ListStore(*column_types)
    self.listmodel = gtk.TreeModelSort(self.liststore)
    self.listctrl = gtk.TreeView(self.listmodel)
    self.listctrl.column = [None]*len(columns)
    self.listctrl.cell = [None]*len(columns)
    for i, column_label in enumerate(columns):
      cell = gtk.CellRendererText()
      column = gtk.TreeViewColumn(column_label)
      self.listctrl.append_column(column)
      column.set_sort_column_id(i)
      column.pack_start(cell, True)
      column.set_attributes(cell, text=i)
    self.listctrl.get_selection().set_mode(gtk.SELECTION_SINGLE)
    for row in rows :
      self.listmodel.get_model().append(row)
    self.listctrl.connect("cursor-changed", self.OnChange)
    sw = gtk.ScrolledWindow()
    w, h = default_size
    if len(rows) > 10 :
      sw.set_size_request(w, h)
    else :
      sw.set_size_request(w, 30 + (20 * len(rows)))
    sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
    box.pack_start(sw, False, False, 5)
    inside_vbox = gtk.VBox(False, 0)
    sw.add(self.listctrl)

  def OnChange(self, treeview):
    import coot # import dependency
    selection = self.listctrl.get_selection()
    (model, tree_iter) = selection.get_selected()
    if tree_iter is not None :
      row = model[tree_iter]
      xyz = row[-1]
      if isinstance(xyz, tuple) and len(xyz) == 3 :
        set_rotation_centre(*xyz)
        set_zoom(30)
        graphics_draw()

def show_probe_dots(show_dots, overlaps_only):
  import coot # import dependency
  n_objects = number_of_generic_objects()
  sys.stdout.flush()
  if show_dots :
    for object_number in range(n_objects):
      obj_name = generic_object_name(object_number)
      if overlaps_only and not obj_name in ["small overlap", "bad overlap"] :
        sys.stdout.flush()
        set_display_generic_object(object_number, 0)
      else :
        set_display_generic_object(object_number, 1)
  else :
    sys.stdout.flush()
    for object_number in range(n_objects):
      set_display_generic_object(object_number, 0)

def load_pkl(file_name):
  pkl = open(file_name, "rb")
  data = pickle.load(pkl)
  pkl.close()
  return data

data = {}
data['rama'] = [('B', '  87 ', 'ASN', 0.002905483861112255, (211.471, 255.342, 216.498)), ('C', '  87 ', 'ASN', 0.0029267707008941678, (270.631, 268.384, 216.49399999999997))]
data['omega'] = []
data['rota'] = []
data['cbeta'] = []
data['probe'] = [(' A  86  PHE  CE1', ' A  89  GLY  HA2', -0.987, (257.889, 212.647, 216.648)), (' A  86  PHE  HZ ', ' A 195  LYS  HA ', -0.718, (259.275, 214.919, 215.834)), (' A  86  PHE  HE1', ' A  90  VAL  H  ', -0.674, (259.883, 211.653, 217.956)), (' A  66  HIS  HB2', ' A  78  ARG  HE ', -0.638, (267.562, 192.86, 221.067)), (' C1047  TYR  HB2', ' C1067  TYR  HB3', -0.63, (249.999, 258.058, 289.096)), (' A1047  TYR  HB2', ' A1067  TYR  HB3', -0.63, (253.164, 233.8, 289.096)), (' C  66  HIS  HB2', ' C  78  ARG  HE ', -0.624, (278.429, 290.584, 221.016)), (' B1047  TYR  HB2', ' B1067  TYR  HB3', -0.623, (231.001, 242.431, 289.254)), (' B  66  HIS  HB2', ' B  78  ARG  HE ', -0.622, (188.27, 250.933, 221.004)), (' C1052  PHE  HB2', ' C1063  LEU  HB2', -0.62, (240.394, 264.547, 279.243)), (' A  86  PHE  HD1', ' A  90  VAL HG13', -0.62, (258.182, 209.583, 216.873)), (' B1052  PHE  HB2', ' B1063  LEU  HB2', -0.618, (230.264, 230.721, 279.283)), (' A1052  PHE  HB2', ' A1063  LEU  HB2', -0.617, (263.932, 239.329, 279.356)), (' C 596  SER  HB2', ' C 611  LEU  HB3', -0.611, (269.621, 260.344, 250.611)), (' B 596  SER  HB2', ' B 611  LEU  HB3', -0.602, (218.89, 258.405, 250.622)), (' A 106  PHE  HB2', ' A 117  LEU  HB3', -0.597, (262.124, 211.528, 207.412)), (' A 596  SER  HB2', ' A 611  LEU  HB3', -0.595, (245.572, 216.179, 250.482)), (' A1106  GLN HE21', ' A1109  PHE  HB3', -0.591, (252.347, 232.188, 299.378)), (' C  86  PHE  CE1', ' C  90  VAL HG22', -0.59, (266.973, 275.465, 216.469)), (' C 106  PHE  HB2', ' C 117  LEU  HB3', -0.589, (265.159, 276.379, 207.853)), (' B1106  GLN HE21', ' B1109  PHE  HB3', -0.589, (229.493, 244.245, 299.301)), (' C1106  GLN HE21', ' C1109  PHE  HB3', -0.589, (251.971, 258.384, 299.369)), (' B 106  PHE  HB2', ' B 117  LEU  HB3', -0.586, (207.092, 246.31, 207.374)), (' B  86  PHE  CE1', ' B  90  VAL HG22', -0.579, (207.487, 248.998, 216.113)), (' B 408  ARG  NH1', ' C 376  THR  OG1', -0.559, (249.903, 242.883, 201.085)), (' C 393  THR  HA ', ' C 522  ALA  HA ', -0.559, (271.219, 234.48, 212.613)), (' A 393  THR  HA ', ' A 522  ALA  HA ', -0.558, (222.944, 226.674, 212.85)), (' B 393  THR  HA ', ' B 522  ALA  HA ', -0.557, (240.53, 272.794, 212.603)), (' A  86  PHE  CZ ', ' A 195  LYS  HA ', -0.557, (258.84, 214.285, 215.935)), (' A 408  ARG  NH1', ' B 376  THR  OG1', -0.555, (243.89, 250.093, 201.029)), (' A 551  VAL  HB ', ' A 588  THR  HB ', -0.555, (230.038, 216.045, 233.033)), (' C1028  LYS  NZ ', ' C1042  PHE  O  ', -0.554, (247.437, 253.291, 276.177)), (' C 815  ARG HH11', ' C 823  PHE  HD2', -0.552, (232.733, 271.792, 266.751)), (' A 376  THR  OG1', ' C 408  ARG  NH1', -0.551, (240.626, 241.318, 201.093)), (' B1028  LYS  NZ ', ' B1042  PHE  O  ', -0.551, (236.187, 242.821, 276.22)), (' B 815  ARG HH11', ' B 823  PHE  HD2', -0.55, (227.523, 221.388, 266.751)), (' B 551  VAL  HB ', ' B 588  THR  HB ', -0.547, (227.309, 271.752, 232.993)), (' B 296  LEU  HB2', ' B 608  VAL HG11', -0.545, (211.571, 250.902, 246.82)), (' A 815  ARG HH11', ' A 823  PHE  HD2', -0.545, (274.231, 241.63, 266.709)), (' C 296  LEU  HB2', ' C 608  VAL HG11', -0.544, (266.694, 270.528, 246.841)), (' B 403  ARG  NH1', ' C 372  ALA  O  ', -0.542, (259.05, 248.36, 190.438)), (' A 350  VAL HG21', ' A 418  ILE HD12', -0.54, (227.027, 249.154, 195.871)), (' A 385  THR  OG1', ' B 985  ASP  OD1', -0.538, (241.863, 228.965, 211.781)), (' C 551  VAL  HB ', ' C 588  THR  HB ', -0.538, (277.055, 246.475, 233.176)), (' B 385  THR  OG1', ' C 985  ASP  OD1', -0.538, (232.368, 255.235, 211.861)), (' C 290  ASP  HB3', ' C 293  LEU  HG ', -0.538, (265.352, 271.676, 236.01)), (' A1028  LYS  NZ ', ' A1042  PHE  O  ', -0.537, (251.035, 238.526, 275.854)), (' A 372  ALA  O  ', ' C 403  ARG  NH1', -0.535, (240.29, 230.35, 190.402)), (' A 985  ASP  OD1', ' C 385  THR  OG1', -0.534, (260.01, 250.089, 211.798)), (' A 296  LEU  HB2', ' A 608  VAL HG11', -0.534, (256.006, 212.915, 246.769)), (' A 884  SER  HA ', ' A 895  GLN  HA ', -0.534, (265.398, 252.516, 291.046)), (' B 534  VAL HG11', ' B 537  LYS  HE2', -0.533, (218.385, 273.243, 226.013)), (' B 290  ASP  HB3', ' B 293  LEU  HG ', -0.533, (211.257, 249.143, 236.053)), (' A 403  ARG  NH1', ' B 372  ALA  O  ', -0.532, (234.512, 255.381, 190.332)), (' A 845  ALA  HB3', ' A 848  ASP  HB2', -0.531, (275.947, 236.909, 242.893)), (' C 534  VAL HG11', ' C 537  LYS  HE2', -0.531, (282.71, 253.554, 225.957)), (' A  86  PHE  HE1', ' A 194  PHE  O  ', -0.529, (259.904, 212.321, 217.328)), (' A 290  ASP  HB3', ' A 293  LEU  HG ', -0.529, (257.735, 214.037, 235.707)), (' B 845  ALA  HB3', ' B 848  ASP  HB2', -0.529, (222.678, 222.138, 242.791)), (' C  86  PHE  O  ', ' C  88  ASP  N  ', -0.528, (269.378, 269.343, 217.616)), (' A 534  VAL HG11', ' A 537  LYS  HE2', -0.527, (233.768, 207.968, 226.256)), (' C 884  SER  HA ', ' C 895  GLN  HA ', -0.525, (227.837, 258.839, 291.005)), (' C  58  PHE  HB2', ' C 293  LEU HD21', -0.52, (266.414, 273.909, 235.106)), (' A 328  ARG HH21', ' A 533  LEU  HB2', -0.52, (226.266, 210.104, 219.777)), (' C 845  ALA  HB3', ' C 848  ASP  HB2', -0.518, (235.807, 275.576, 242.933)), (' B 350  VAL HG21', ' B 418  ILE HD12', -0.518, (257.675, 258.069, 196.036)), (' B  86  PHE  O  ', ' B  88  ASP  N  ', -0.518, (210.98, 253.213, 217.436)), (' B  35  GLY  HA3', ' B  56  LEU  HB3', -0.515, (207.851, 245.552, 227.172)), (' B 905  ARG  O  ', ' B1036  GLN  NE2', -0.513, (236.889, 238.78, 290.969)), (' C 350  VAL HG21', ' C 418  ILE HD12', -0.513, (249.975, 227.342, 195.846)), (' A 337  PRO  HB2', ' A 340  GLU  HB2', -0.513, (222.309, 227.561, 194.599)), (' C 328  ARG HH21', ' C 533  LEU  HB2', -0.511, (284.107, 246.043, 219.783)), (' A 742  ILE  O  ', ' A1000  ARG  NH1', -0.51, (259.626, 247.396, 231.603)), (' B 328  ARG HH21', ' B 533  LEU  HB2', -0.51, (224.04, 278.135, 219.807)), (' B 884  SER  HA ', ' B 895  GLN  HA ', -0.51, (240.746, 223.389, 290.802)), (' A  58  PHE  HB2', ' A 293  LEU HD21', -0.509, (259.174, 211.631, 235.121)), (' C 337  PRO  HB2', ' C 340  GLU  HB2', -0.506, (270.884, 233.833, 194.656)), (' B 337  PRO  HB2', ' B 340  GLU  HB2', -0.505, (240.922, 272.781, 195.059)), (' C  35  GLY  HA3', ' C  56  LEU  HB3', -0.504, (263.517, 276.514, 227.471)), (' A1012  LEU  HB3', ' C1013  ILE HG21', -0.503, (247.611, 248.125, 253.361)), (' C  86  PHE  HE1', ' C  90  VAL HG22', -0.502, (266.33, 275.129, 216.447)), (' A1013  ILE HG21', ' B1012  LEU  HB3', -0.5, (246.206, 240.687, 253.378)), (' B 985  ASP  HB3', ' B 987  PRO  HD2', -0.5, (245.669, 231.557, 213.977)), (' B 325  SER  HA ', ' B 540  ASN  HB3', -0.499, (222.748, 266.088, 221.908)), (' B 805  ILE HD12', ' B 878  LEU HD11', -0.499, (231.346, 226.13, 282.084)), (' B  58  PHE  HB2', ' B 293  LEU HD21', -0.499, (208.909, 248.961, 235.087)), (' A 325  SER  HA ', ' A 540  ASN  HB3', -0.498, (237.164, 215.042, 221.978)), (' A 755  GLN  HB3', ' C 969  ASN HD22', -0.498, (250.036, 258.909, 227.756)), (' B 985  ASP  O  ', ' B 989  ALA  N  ', -0.497, (243.251, 233.644, 217.785)), (' A 985  ASP  O  ', ' A 989  ALA  N  ', -0.496, (255.195, 248.96, 217.671)), (' C 985  ASP  HB3', ' C 987  PRO  HD2', -0.495, (232.884, 251.131, 213.909)), (' A 969  ASN HD22', ' B 755  GLN  HB3', -0.495, (254.401, 233.217, 227.725)), (' C 921  LYS  O  ', ' C 925  ASN  ND2', -0.495, (245.669, 274.237, 295.348)), (' B 129  LYS  NZ ', ' B 160  TYR  OH ', -0.495, (200.355, 240.789, 197.831)), (' A 805  ILE HD12', ' A 878  LEU HD11', -0.494, (268.001, 242.171, 282.067)), (' B1013  ILE HG21', ' C1012  LEU  HB3', -0.494, (239.94, 245.793, 253.133)), (' A  35  GLY  HA3', ' A  56  LEU  HB3', -0.492, (262.604, 212.179, 227.341)), (' B 969  ASN HD22', ' C 755  GLN  HB3', -0.491, (229.946, 242.234, 227.804)), (' C 805  ILE HD12', ' C 878  LEU HD11', -0.491, (235.447, 266.242, 282.154)), (' C 325  SER  HA ', ' C 540  ASN  HB3', -0.491, (274.696, 253.447, 221.684)), (' A 985  ASP  HB3', ' A 987  PRO  HD2', -0.49, (255.769, 252.083, 213.985)), (' B 921  LYS  O  ', ' B 925  ASN  ND2', -0.49, (218.593, 230.447, 295.132)), (' C 985  ASP  O  ', ' C 989  ALA  N  ', -0.489, (235.989, 251.661, 217.722)), (' B 877  LEU HD22', ' B1034  LEU HD11', -0.488, (242.039, 228.148, 278.722)), (' C 905  ARG  O  ', ' C1036  GLN  NE2', -0.486, (243.653, 254.47, 291.046)), (' A 726  ILE HG22', ' A 948  LEU HD13', -0.486, (259.948, 236.831, 266.749)), (' A 877  LEU HD22', ' A1034  LEU HD11', -0.485, (261.035, 250.89, 278.677)), (' C 726  ILE HG22', ' C 948  LEU HD13', -0.485, (244.089, 261.784, 266.807)), (' B  86  PHE  HE1', ' B  90  VAL HG22', -0.483, (207.751, 248.214, 216.456)), (' A 921  LYS  O  ', ' A 925  ASN  ND2', -0.482, (270.358, 229.337, 295.12)), (' B 726  ILE HG22', ' B 948  LEU HD13', -0.481, (230.46, 235.487, 266.815)), (' A 317  ASN  ND2', ' B 740  MET  SD ', -0.481, (240.022, 222.326, 239.808)), (' A  86  PHE  CE1', ' A 194  PHE  O  ', -0.479, (260.185, 212.982, 217.093)), (' A 740  MET  SD ', ' C 317  ASN  ND2', -0.478, (266.343, 251.7, 239.848)), (' C 206  LYS  HB2', ' C 223  LEU  HA ', -0.477, (256.137, 283.491, 224.369)), (' B 398  ASP  HB2', ' B 512  VAL  HB ', -0.477, (249.556, 262.273, 201.859)), (' B1011  GLN  OE1', ' B1014  ARG  NH1', -0.477, (236.911, 236.99, 251.389)), (' C 957  GLN  O  ', ' C 961  THR  N  ', -0.477, (244.079, 261.798, 245.36)), (' B 317  ASN  ND2', ' C 740  MET  SD ', -0.474, (227.855, 260.605, 239.534)), (' A 129  LYS  NZ ', ' A 160  TYR  OH ', -0.474, (270.527, 208.264, 197.899)), (' B  21  ARG  NH2', ' B  79  PHE  O  ', -0.473, (189.141, 254.222, 213.378)), (' C 877  LEU HD22', ' C1034  LEU HD11', -0.473, (231.888, 255.651, 278.884)), (' C 398  ASP  HB2', ' C 512  VAL  HB ', -0.472, (258.173, 231.888, 201.678)), (' B 957  GLN  O  ', ' B 961  THR  N  ', -0.472, (230.399, 235.524, 245.371)), (' A 667  GLY  HA2', ' B 864  LEU  HA ', -0.471, (242.648, 220.397, 259.957)), (' A 398  ASP  HB2', ' A 512  VAL  HB ', -0.471, (227.052, 239.814, 201.478)), (' A1011  GLN  OE1', ' A1014  ARG  NH1', -0.471, (255.564, 242.41, 251.234)), (' B 206  LYS  HB2', ' B 223  LEU  HA ', -0.47, (205.964, 235.501, 224.584)), (' C 129  LYS  NZ ', ' C 160  TYR  OH ', -0.47, (263.55, 285.416, 197.817)), (' A 913  GLN  NE2', ' C1090  PRO  O  ', -0.468, (255.251, 243.663, 303.557)), (' C  21  ARG  NH2', ' C  79  PHE  O  ', -0.466, (281.085, 287.961, 213.098)), (' A1102  TRP  HB2', ' A1135  ASN HD22', -0.466, (241.058, 225.379, 312.133)), (' C 742  ILE  O  ', ' C1000  ARG  NH1', -0.465, (235.058, 256.485, 231.707)), (' A 277  LEU HD22', ' A 285  ILE HD13', -0.463, (267.581, 221.46, 230.945)), (' A  86  PHE  CE1', ' A  90  VAL  N  ', -0.462, (259.137, 211.532, 218.063)), (' B 667  GLY  HA2', ' C 864  LEU  HA ', -0.462, (224.661, 258.693, 259.489)), (' B1102  TRP  HB2', ' B1135  ASN HD22', -0.461, (230.07, 257.939, 312.455)), (' B 726  ILE HD13', ' B 945  LEU HD23', -0.461, (226.525, 234.536, 268.341)), (' A  21  ARG  NH2', ' A  79  PHE  O  ', -0.46, (264.374, 191.76, 213.39)), (' A  67  ALA  HB3', ' A 263  ALA  HB3', -0.46, (272.452, 195.442, 217.502)), (' A 864  LEU  HA ', ' C 667  GLY  HA2', -0.459, (266.993, 255.077, 259.923)), (' B  67  ALA  HB3', ' B 263  ALA  HB3', -0.458, (188.307, 245.629, 217.593)), (' A 381  GLY  HA3', ' A 430  THR HG23', -0.457, (232.835, 237.527, 213.799)), (' C  92  PHE  HB3', ' C 192  PHE  HB2', -0.457, (263.564, 282.038, 218.914)), (' A 206  LYS  HB2', ' A 223  LEU  HA ', -0.457, (272.371, 215.948, 224.587)), (' C 277  LEU HD22', ' C 285  ILE HD13', -0.457, (253.994, 275.854, 231.071)), (' A1090  PRO  O  ', ' B 913  GLN  NE2', -0.456, (238.364, 236.508, 303.791)), (' B 280  ASN  OD1', ' B 284  THR  N  ', -0.456, (211.638, 228.315, 233.29)), (' B 564  GLN  NE2', ' B 577  ARG  O  ', -0.456, (235.406, 276.622, 220.201)), (' C  67  ALA  HB3', ' C 263  ALA  HB3', -0.454, (273.447, 293.148, 217.82)), (' B 277  LEU HD22', ' B 285  ILE HD13', -0.454, (213.232, 236.708, 230.929)), (' C 726  ILE HD13', ' C 945  LEU HD23', -0.453, (244.957, 265.695, 268.389)), (' A 726  ILE HD13', ' A 945  LEU HD23', -0.453, (262.834, 234.244, 268.37)), (' A  92  PHE  HB3', ' A 192  PHE  HB2', -0.452, (267.824, 209.422, 219.16)), (' A 853  GLN  NE2', ' A 960  ASN  OD1', -0.451, (264.995, 239.05, 245.785)), (' C 564  GLN  NE2', ' C 577  ARG  O  ', -0.451, (277.083, 237.049, 220.198)), (' A 280  ASN  OD1', ' A 284  THR  N  ', -0.449, (275.69, 224.402, 233.244)), (' C 381  GLY  HA3', ' C 430  THR HG23', -0.449, (257.53, 237.862, 213.745)), (' B1090  PRO  O  ', ' C 913  GLN  NE2', -0.448, (240.53, 254.807, 303.43)), (' B 108  THR  O  ', ' B 236  THR  OG1', -0.448, (208.385, 256.049, 208.399)), (' B 742  ILE  O  ', ' B1000  ARG  NH1', -0.447, (239.582, 230.627, 231.67)), (' C 246  ARG  NH2', ' C 257  GLY  O  ', -0.447, (282.43, 301.774, 208.172)), (' C 853  GLN  NE2', ' C 960  ASN  OD1', -0.447, (239.5, 265.419, 245.686)), (' C1102  TRP  HB2', ' C1135  ASN HD22', -0.446, (263.621, 251.141, 312.596)), (' A 564  GLN  NE2', ' A 577  ARG  O  ', -0.446, (222.067, 220.702, 220.034)), (' A 566  GLY  O  ', ' A 574  ASP  N  ', -0.445, (225.669, 225.316, 229.35)), (' A 108  THR  O  ', ' A 236  THR  OG1', -0.444, (253.282, 207.384, 208.043)), (' B 853  GLN  NE2', ' B 960  ASN  OD1', -0.442, (229.554, 229.781, 245.697)), (' B 390  LEU HD21', ' B 517  LEU HD21', -0.442, (239.357, 263.102, 215.277)), (' C 498  GLN  OE1', ' C 501  ASN  ND2', -0.442, (245.446, 232.928, 180.419)), (' B  92  PHE  HB3', ' B 192  PHE  HB2', -0.442, (202.744, 242.669, 219.007)), (' A 352  ALA  HB1', ' A 466  ARG HH21', -0.441, (216.532, 244.568, 195.274)), (' C 390  LEU HD21', ' C 517  LEU HD21', -0.44, (263.703, 240.659, 215.283)), (' C 108  THR  O  ', ' C 236  THR  OG1', -0.44, (272.938, 270.727, 207.97)), (' A 760  CYS  O  ', ' A 764  ASN  ND2', -0.439, (256.132, 256.288, 242.337)), (' A 327  VAL  HA ', ' A 542  ASN  HB3', -0.439, (232.252, 217.141, 217.77)), (' A  86  PHE  CD1', ' A  90  VAL HG22', -0.439, (259.775, 210.328, 216.783)), (' C 125  ASN  ND2', ' C 172  SER  O  ', -0.439, (253.003, 291.222, 203.732)), (' B 381  GLY  HA3', ' B 430  THR HG23', -0.438, (244.375, 259.241, 213.82)), (' B 566  GLY  O  ', ' B 574  ASP  N  ', -0.438, (237.428, 271.199, 229.358)), (' C  18  LEU HD11', ' C 244  LEU HD21', -0.438, (278.047, 293.537, 208.288)), (' C 454  ARG  NH2', ' C 467  ASP  OD2', -0.437, (249.85, 216.826, 198.312)), (' B  18  LEU HD11', ' B 244  LEU HD21', -0.437, (185.794, 249.222, 208.204)), (' B 125  ASN  ND2', ' B 172  SER  O  ', -0.436, (200.519, 228.682, 203.715)), (' C 352  ALA  HB1', ' C 466  ARG HH21', -0.436, (259.365, 220.739, 195.616)), (' B1104  VAL  HB ', ' B1115  ILE HG12', -0.436, (232.66, 252.584, 309.45)), (' A 905  ARG  O  ', ' A1036  GLN  NE2', -0.435, (253.834, 240.862, 290.973)), (' A 390  LEU HD21', ' A 517  LEU HD21', -0.435, (231.569, 230.916, 215.306)), (' A 726  ILE HG23', ' A1061  VAL HG22', -0.434, (261.846, 237.021, 269.435)), (' C 327  VAL  HA ', ' C 542  ASN  HB3', -0.433, (275.065, 247.666, 217.719)), (' B 454  ARG  NH2', ' B 467  ASP  OD2', -0.433, (266.602, 262.996, 198.415)), (' C 726  ILE HG23', ' C1061  VAL HG22', -0.433, (242.814, 263.758, 269.65)), (' C 102  ARG  NH2', ' C 154  GLU  OE2', -0.432, (265.025, 295.065, 207.127)), (' A 976  VAL HG12', ' A 978  ASN  H  ', -0.432, (263.792, 243.527, 226.519)), (' A 339  GLY  HA2', ' A 343  ASN  HB2', -0.432, (227.881, 227.886, 190.957)), (' B 102  ARG  NH2', ' B 154  GLU  OE2', -0.432, (191.253, 236.881, 207.148)), (' A  18  LEU HD11', ' A 244  LEU HD21', -0.432, (270.017, 191.419, 208.378)), (' A1039  ARG  NE ', ' B1031  GLU  OE2', -0.432, (245.944, 241.669, 278.716)), (' B 205  SER  N  ', ' B 224  GLU  O  ', -0.431, (207.279, 235.171, 220.531)), (' A  33  THR  OG1', ' A 219  GLY  O  ', -0.431, (268.701, 210.804, 234.493)), (' B1051  SER  OG ', ' B1064  HIS  ND1', -0.429, (233.768, 236.649, 279.605)), (' C 102  ARG  NH2', ' C 121  ASN  O  ', -0.429, (264.234, 293.009, 207.261)), (' C  33  THR  OG1', ' C 219  GLY  O  ', -0.429, (262.297, 282.477, 234.392)), (' C1104  VAL  HB ', ' C1115  ILE HG12', -0.429, (258.024, 251.333, 309.73)), (' B  25  PRO  HA ', ' B  26  PRO  HD3', -0.429, (191.847, 261.77, 221.387)), (' C 205  SER  N  ', ' C 224  GLU  O  ', -0.429, (255.221, 282.171, 220.521)), (' B  33  THR  OG1', ' B 219  GLY  O  ', -0.429, (203.417, 241.052, 234.501)), (' A  67  ALA  HB2', ' A 242  LEU HD13', -0.428, (270.274, 195.277, 215.738)), (' A 125  ASN  ND2', ' A 172  SER  O  ', -0.427, (280.953, 214.515, 203.88)), (' A 338  PHE  HB3', ' A 368  LEU HD21', -0.426, (230.192, 227.517, 195.427)), (' A 957  GLN  O  ', ' A 961  THR  N  ', -0.426, (259.975, 236.819, 245.347)), (' B 965  GLN HE22', ' C 762  GLN HE22', -0.426, (235.795, 241.11, 240.056)), (' A1104  VAL  HB ', ' A1115  ILE HG12', -0.426, (243.861, 230.138, 309.719)), (' B 726  ILE HG23', ' B1061  VAL HG22', -0.426, (229.639, 233.614, 269.782)), (' B 276  LEU HD11', ' B 301  CYS  HA ', -0.425, (219.198, 243.656, 239.447)), (' A 707  TYR  HB3', ' B 792  PRO  HG3', -0.424, (235.733, 216.979, 290.625)), (' B 352  ALA  HB1', ' B 466  ARG HH21', -0.424, (258.618, 269.395, 195.239)), (' B 717  ASN  HB3', ' B1071  GLN  HB2', -0.424, (218.771, 245.319, 295.553)), (' B 327  VAL  HA ', ' B 542  ASN  HB3', -0.423, (226.77, 269.729, 217.654)), (' A 778  THR HG22', ' A 865  LEU HD22', -0.423, (263.353, 251.821, 266.817)), (' B 707  TYR  HB3', ' C 792  PRO  HG3', -0.422, (225.645, 266.278, 290.642)), (' A 792  PRO  HG3', ' C 707  TYR  HB3', -0.422, (273.014, 250.844, 290.683)), (' C  25  PRO  HA ', ' C  26  PRO  HD3', -0.422, (285.887, 282.397, 221.154)), (' A 205  SER  N  ', ' A 224  GLU  O  ', -0.422, (271.57, 217.238, 220.436)), (' A1051  SER  OG ', ' A1064  HIS  ND1', -0.422, (257.494, 239.167, 279.736)), (' C1011  GLN  OE1', ' C1014  ARG  NH1', -0.421, (241.922, 255.479, 251.447)), (' B1039  ARG  NE ', ' C1031  GLU  OE2', -0.421, (241.588, 245.428, 278.613)), (' A 970  PHE  HE1', ' B 759  PHE  HZ ', -0.42, (253.074, 239.361, 234.992)), (' A 745  ASP  HB3', ' C 549  THR  HB ', -0.42, (269.609, 251.237, 229.36)), (' A 616  ASN  HB2', ' B 836  GLN HE22', -0.42, (233.833, 209.103, 246.7)), (' B 102  ARG  NH2', ' B 121  ASN  O  ', -0.419, (193.347, 237.554, 207.497)), (' B 351  TYR  HE1', ' B 452  LEU  HB2', -0.419, (261.099, 263.604, 190.226)), (' C1051  SER  OG ', ' C1064  HIS  ND1', -0.419, (243.255, 258.407, 279.58)), (' C 778  THR HG22', ' C 865  LEU HD22', -0.419, (229.907, 257.31, 266.848)), (' B 976  VAL HG12', ' B 978  ASN  H  ', -0.419, (234.582, 228.835, 226.349)), (' B 369  TYR  HA ', ' B 372  ALA  HB2', -0.418, (232.745, 259.091, 193.711)), (' B 340  GLU  OE1', ' B 356  LYS  NZ ', -0.418, (242.828, 274.953, 195.082)), (' B 970  PHE  HE1', ' C 759  PHE  HZ ', -0.418, (235.943, 240.246, 235.039)), (' A 369  TYR  HA ', ' A 372  ALA  HB2', -0.418, (238.471, 226.927, 194.121)), (' A  86  PHE  CG ', ' A  86  PHE  O  ', -0.417, (256.181, 210.961, 215.074)), (' B 338  PHE  HB3', ' B 368  LEU HD21', -0.417, (237.184, 266.104, 195.373)), (' A 454  ARG  NH2', ' A 467  ASP  OD2', -0.417, (218.107, 254.712, 198.492)), (' B 119  ILE HG12', ' B 128  ILE HG12', -0.416, (205.062, 238.909, 207.978)), (' A 820  ASP  O  ', ' A 824  ASN  ND2', -0.416, (275.045, 235.877, 267.383)), (' B 903  ALA  HB1', ' B 913  GLN  HB2', -0.415, (234.571, 234.982, 299.8)), (' A 146  HIS  HB3', ' A 150  LYS  HG3', -0.413, (287.822, 190.513, 209.86)), (' B 662  CYS  HB2', ' B 697  MET  HG3', -0.413, (219.729, 256.189, 266.013)), (' A 351  TYR  HE1', ' A 452  LEU  HB2', -0.413, (220.562, 249.796, 189.957)), (' B 117  LEU HD22', ' B 231  ILE HG21', -0.413, (209.89, 242.899, 207.853)), (' C 976  VAL HG12', ' C 978  ASN  H  ', -0.412, (236.052, 261.699, 226.324)), (' C 369  TYR  HA ', ' C 372  ALA  HB2', -0.412, (263.584, 248.127, 193.921)), (' C 760  CYS  O  ', ' C 764  ASN  ND2', -0.412, (229.12, 249.252, 242.505)), (' A1031  GLU  OE2', ' C1039  ARG  NE ', -0.412, (246.919, 247.425, 278.652)), (' C 140  PHE  HB2', ' C 244  LEU HD13', -0.411, (274.469, 293.234, 208.08)), (' C 117  LEU HD22', ' C 231  ILE HG21', -0.411, (260.635, 275.922, 207.858)), (' B 374  PHE  HA ', ' B 436  TRP  HB3', -0.411, (240.853, 256.483, 194.131)), (' B 778  THR HG22', ' B 865  LEU HD22', -0.411, (241.354, 225.574, 266.9)), (' C 403  ARG  NH2', ' C 406  GLU  OE2', -0.411, (242.586, 230.504, 193.886)), (' B1018  ILE  O  ', ' B1022  ALA  N  ', -0.411, (240.567, 237.201, 265.311)), (' B  67  ALA  HB2', ' B 242  LEU HD13', -0.41, (189.392, 247.58, 215.421)), (' C 811  LYS  NZ ', ' C 820  ASP  OD2', -0.41, (233.202, 277.187, 271.527)), (' A 246  ARG  NH2', ' A 257  GLY  O  ', -0.41, (275.003, 183.85, 207.984)), (' C 316  SER  OG ', ' C 317  ASN  N  ', -0.409, (265.316, 256.666, 240.195)), (' C 566  GLY  O  ', ' C 574  ASP  N  ', -0.409, (271.195, 238.049, 229.201)), (' B  91  TYR  N  ', ' B 268  GLY  O  ', -0.409, (206.331, 248.387, 222.035)), (' A 549  THR  HB ', ' B 745  ASP  HB3', -0.408, (238.136, 220.25, 229.722)), (' B 140  PHE  HB2', ' B 244  LEU HD13', -0.408, (187.988, 246.293, 208.045)), (' C 117  LEU HD22', ' C 231  ILE HD13', -0.408, (261.397, 275.688, 208.501)), (' C 662  CYS  HB2', ' C 697  MET  HG3', -0.408, (266.865, 261.009, 265.91)), (' C 820  ASP  O  ', ' C 824  ASN  ND2', -0.408, (237.474, 275.507, 267.45)), (' C 280  ASN  OD1', ' C 284  THR  N  ', -0.408, (246.899, 281.648, 233.222)), (' B 403  ARG  NH2', ' B 406  GLU  OE2', -0.408, (258.278, 249.683, 193.611)), (' C 119  ILE HG12', ' C 128  ILE HG12', -0.407, (259.613, 282.126, 207.805)), (' A 316  SER  OG ', ' A 317  ASN  N  ', -0.407, (244.812, 221.16, 240.197)), (' A  48  LEU HD11', ' A 276  LEU  HB3', -0.407, (263.334, 223.343, 237.667)), (' A 965  GLN HE22', ' B 762  GLN HE22', -0.407, (252.552, 238.858, 240.127)), (' C 128  ILE  HB ', ' C 170  TYR  HB3', -0.407, (256.187, 282.294, 205.067)), (' A 340  GLU  OE1', ' A 356  LYS  NZ ', -0.407, (219.767, 227.987, 195.14)), (' A 970  PHE  HD2', ' A 996  LEU  HA ', -0.407, (254.344, 243.405, 230.12)), (' A 759  PHE  HZ ', ' C 970  PHE  HE1', -0.406, (245.338, 254.656, 234.993)), (' C 351  TYR  HE1', ' C 452  LEU  HB2', -0.406, (252.65, 221.282, 189.94)), (' A 762  GLN HE22', ' C 965  GLN HE22', -0.405, (246.099, 254.464, 240.097)), (' B 820  ASP  O  ', ' B 824  ASN  ND2', -0.405, (221.918, 223.125, 267.383)), (' C 276  LEU HD11', ' C 301  CYS  HA ', -0.405, (256.597, 267.502, 239.331)), (' C 459  SER  OG ', ' C 460  ASN  N  ', -0.404, (244.344, 217.095, 207.168)), (' C 338  PHE  HB3', ' C 368  LEU HD21', -0.404, (267.465, 240.587, 195.555)), (' A 117  LEU HD22', ' A 231  ILE HG21', -0.404, (263.819, 215.169, 208.074)), (' B 549  THR  HB ', ' C 745  ASP  HB3', -0.403, (226.768, 263.088, 229.423)), (' A 140  PHE  HB2', ' A 244  LEU HD13', -0.403, (271.831, 194.952, 208.207)), (' B 117  LEU HD22', ' B 231  ILE HD13', -0.403, (210.112, 243.855, 208.649)), (' C 146  HIS  HB3', ' C 150  LYS  HG3', -0.403, (270.009, 309.352, 209.72)), (' C  48  LEU HD11', ' C 276  LEU  HB3', -0.402, (254.133, 271.573, 237.66)), (' B  48  LEU HD11', ' B 276  LEU  HB3', -0.402, (216.869, 239.087, 237.803)), (' B 616  ASN  HB2', ' C 836  GLN HE22', -0.402, (219.06, 272.194, 246.968)), (' B 195  LYS  HE3', ' B 202  LYS  HD2', -0.401, (215.88, 241.823, 218.538)), (' A 276  LEU HD11', ' A 301  CYS  HA ', -0.401, (258.977, 223.128, 239.374)), (' C 948  LEU HD21', ' C1059  GLY  HA3', -0.4, (240.121, 261.475, 266.005)), (' A 459  SER  OG ', ' A 460  ASN  N  ', -0.4, (221.269, 259.65, 207.092)), (' B 970  PHE  HD2', ' B 996  LEU  HA ', -0.4, (238.362, 236.982, 230.147)), (' A 175  PHE  HE2', ' A 177  MET  HE3', -0.4, (281.551, 208.425, 211.226))]
handle_read_draw_probe_dots_unformatted("molprobity_probe.txt", 0, 0)
show_probe_dots(True, True)
gui = coot_molprobity_todo_list_gui(data=data)
